{"version":3,"file":"commonHelpers.js","sources":["../src/js/cart/cart.js","../src/js/cart/delete-from-cart.js","../src/js/cart/general-sum.js","../src/js/cart/delete-product.js","../src/js/requests/orders.js","../src/js/cart/send-products.js","../src/cart.js"],"sourcesContent":["import { common } from '../common/common';\nimport { quantityProduct } from '../helpers/helpers';\nimport { createMarkupCartList, createMarkupEmptyCart } from '../services/markup';\nimport { refs } from '../services/refs';\nimport { getData } from '../services/storage';\n\nexport async function handleCart() {\n    const cartArr = getData(common.CART_KEY);\n    \n    quantityProduct(cartArr);\n\n    if (!cartArr.length) {\n        refs.cardWrapper.innerHTML = createMarkupEmptyCart();\n        return\n    }\n\n    refs.cartProducts.insertAdjacentHTML(\"beforeend\", createMarkupCartList(cartArr));\n\n\n\n\n}\n\n\n","import { common } from \"../common/common\";\nimport { quantityProduct } from \"../helpers/helpers\";\nimport { createMarkupEmptyCart } from \"../services/markup\";\nimport { refs } from \"../services/refs\";\n\nexport async function handleDeleteAllFromCart() {\n\n    localStorage.removeItem(common.CART_KEY)\n    \n    refs.cardWrapper.innerHTML = createMarkupEmptyCart();\n\n    refs.cartQuantity.forEach(item => item.textContent = 0)\n\n} ","import { common } from \"../common/common\";\nimport { refs } from \"../services/refs\";\nimport { getData } from \"../services/storage\";\n\nexport async function generalSum() {\n    const cartArr = getData(common.CART_KEY);\n    \n    const totalSum = cartArr.reduce((total, {price}) => {\n        return total + price;\n    }, 0)\n\n    refs.totalPrice.textContent = `$${Number(totalSum.toFixed(2))}`\n}","import { common } from \"../common/common\";\nimport { quantityProduct } from \"../helpers/helpers\";\nimport { createMarkupCartList, createMarkupEmptyCart } from \"../services/markup\";\nimport { refs } from \"../services/refs\";\nimport { getData, saveData } from \"../services/storage\";\nimport { generalSum } from \"./general-sum\";\n\nexport async function handleDeleteProduct(event) {\n    const { target } = event;\n\n    const deleteBtn = target.closest(\".cart__item-close\");\n\n    if(!deleteBtn) {\n        return\n    }\n\n    const {id} = deleteBtn.closest(\".cart__products-item\").dataset;\n\n    const cartArr = getData(common.CART_KEY);\n\n    const findProductIndex = cartArr.findIndex(({_id}) => _id === id)\n\n    cartArr.splice(findProductIndex, 1);\n\n    saveData(cartArr, common.CART_KEY)\n\n    refs.cartProducts.innerHTML = createMarkupCartList(cartArr)\n\n    generalSum();\n\n    quantityProduct(cartArr);\n\n    if(!cartArr.length) {\n        refs.cardWrapper.innerHTML = createMarkupEmptyCart();\n        localStorage.removeItem(common.CART_KEY)\n    }\n}\n","import { apiOrders } from '../services/api';\n\nexport async function fetchSendOrder(email, arr) {\n    const products = arr.map(({ _id }) => ({ productId: _id, amount: 1 }));\n    \n    const submitBtn = document.querySelector(\".cart__submit-button\");\n\n    submitBtn.disabled = true;\n\n    const response = await apiOrders({\n        method: 'POST',\n        data: {\n            email: email,\n            products: products,\n        },\n    });\n\n\n    return response.data;\n}\n","import * as basicLightbox from 'basiclightbox';\nimport 'basiclightbox/dist/basicLightbox.min.css';\n\nimport { common } from '../common/common';\nimport { fetchSendOrder } from '../requests/orders';\nimport { getData } from '../services/storage';\nimport { createMarkupEmptyCart, createMarkupSuccessOrder } from '../services/markup';\nimport { refs } from '../services/refs';\n\nexport async function handleSendProducts(event) {\n    event.preventDefault();\n\n    const submitBtn = document.querySelector('.cart__submit-button');\n\n    const { email } = event.currentTarget.elements;\n\n    const emailValue = email.value.trim();\n\n    if (!emailValue) {\n        return;\n    }\n\n    const cartArr = getData(common.CART_KEY);\n    try {\n        const data = await fetchSendOrder(emailValue, cartArr);\n\n        const instance = basicLightbox.create(\n            createMarkupSuccessOrder(data.message),\n            {\n                onShow: instance => {\n                    instance\n                        .element()\n                        .querySelector('.checkout__close').onclick =\n                        instance.close;\n                },\n            }\n        );\n\n        instance.show();\n\n        refs.sendForm.reset();\n\n        refs.cardWrapper.innerHTML = createMarkupEmptyCart();\n\n        localStorage.removeItem(common.CART_KEY);\n\n        refs.cartQuantity.forEach(item => item.textContent = 0)\n\n        submitBtn.disabled = false;\n    } catch (error) {\n        console.log(error)\n    }\n}\n","import { handleCart } from './js/cart/cart';\nimport { handleDeleteAllFromCart } from './js/cart/delete-from-cart';\nimport { handleDeleteProduct } from './js/cart/delete-product';\nimport { generalSum } from './js/cart/general-sum';\nimport { handleSendProducts } from './js/cart/send-products';\nimport { refs } from './js/services/refs';\n\nhandleCart();\n\nrefs.deleteAllProductsFromCart.addEventListener(\n    'click',\n    handleDeleteAllFromCart\n);\n\ngeneralSum();\n\nrefs.cartProducts.addEventListener('click', handleDeleteProduct);\n\nrefs.sendForm.addEventListener('submit', handleSendProducts);\n"],"names":["handleCart","cartArr","getData","common","quantityProduct","refs","createMarkupEmptyCart","createMarkupCartList","handleDeleteAllFromCart","item","generalSum","totalSum","total","price","handleDeleteProduct","event","target","deleteBtn","id","findProductIndex","_id","saveData","fetchSendOrder","email","arr","products","submitBtn","apiOrders","handleSendProducts","emailValue","data","basicLightbox.create","createMarkupSuccessOrder","instance","error"],"mappings":"mJAMO,eAAeA,GAAa,CAC/B,MAAMC,EAAUC,EAAQC,EAAO,QAAQ,EAIvC,GAFAC,EAAgBH,CAAO,EAEnB,CAACA,EAAQ,OAAQ,CACjBI,EAAK,YAAY,UAAYC,IAC7B,MACH,CAEDD,EAAK,aAAa,mBAAmB,YAAaE,EAAqBN,CAAO,CAAC,CAKnF,CChBO,eAAeO,GAA0B,CAE5C,aAAa,WAAWL,EAAO,QAAQ,EAEvCE,EAAK,YAAY,UAAYC,IAE7BD,EAAK,aAAa,QAAQI,GAAQA,EAAK,YAAc,CAAC,CAE1D,CCTO,eAAeC,GAAa,CAG/B,MAAMC,EAFUT,EAAQC,EAAO,QAAQ,EAEd,OAAO,CAACS,EAAO,CAAC,MAAAC,CAAK,IACnCD,EAAQC,EAChB,CAAC,EAEJR,EAAK,WAAW,YAAc,IAAI,OAAOM,EAAS,QAAQ,CAAC,CAAC,GAChE,CCLO,eAAeG,EAAoBC,EAAO,CAC7C,KAAM,CAAE,OAAAC,CAAQ,EAAGD,EAEbE,EAAYD,EAAO,QAAQ,mBAAmB,EAEpD,GAAG,CAACC,EACA,OAGJ,KAAM,CAAC,GAAAC,CAAE,EAAID,EAAU,QAAQ,sBAAsB,EAAE,QAEjDhB,EAAUC,EAAQC,EAAO,QAAQ,EAEjCgB,EAAmBlB,EAAQ,UAAU,CAAC,CAAC,IAAAmB,CAAG,IAAMA,IAAQF,CAAE,EAEhEjB,EAAQ,OAAOkB,EAAkB,CAAC,EAElCE,EAASpB,EAASE,EAAO,QAAQ,EAEjCE,EAAK,aAAa,UAAYE,EAAqBN,CAAO,EAE1DS,IAEAN,EAAgBH,CAAO,EAEnBA,EAAQ,SACRI,EAAK,YAAY,UAAYC,IAC7B,aAAa,WAAWH,EAAO,QAAQ,EAE/C,CClCO,eAAemB,EAAeC,EAAOC,EAAK,CAC7C,MAAMC,EAAWD,EAAI,IAAI,CAAC,CAAE,IAAAJ,CAAG,KAAQ,CAAE,UAAWA,EAAK,OAAQ,CAAC,EAAG,EAE/DM,EAAY,SAAS,cAAc,sBAAsB,EAE/D,OAAAA,EAAU,SAAW,IAEJ,MAAMC,EAAU,CAC7B,OAAQ,OACR,KAAM,CACF,MAAOJ,EACP,SAAUE,CACb,CACT,CAAK,GAGe,IACpB,CCVO,eAAeG,EAAmBb,EAAO,CAC5CA,EAAM,eAAc,EAEpB,MAAMW,EAAY,SAAS,cAAc,sBAAsB,EAEzD,CAAE,MAAAH,CAAO,EAAGR,EAAM,cAAc,SAEhCc,EAAaN,EAAM,MAAM,KAAI,EAEnC,GAAI,CAACM,EACD,OAGJ,MAAM5B,EAAUC,EAAQC,EAAO,QAAQ,EACvC,GAAI,CACA,MAAM2B,EAAO,MAAMR,EAAeO,EAAY5B,CAAO,EAEpC8B,EAAoB,OACjCC,EAAyBF,EAAK,OAAO,EACrC,CACI,OAAQG,GAAY,CAChBA,EACK,QAAS,EACT,cAAc,kBAAkB,EAAE,QACnCA,EAAS,KAChB,CACJ,CACb,EAEiB,KAAI,EAEb5B,EAAK,SAAS,QAEdA,EAAK,YAAY,UAAYC,IAE7B,aAAa,WAAWH,EAAO,QAAQ,EAEvCE,EAAK,aAAa,QAAQI,GAAQA,EAAK,YAAc,CAAC,EAEtDiB,EAAU,SAAW,EACxB,OAAQQ,EAAP,CACE,QAAQ,IAAIA,CAAK,CACpB,CACL,CC7CAlC,IAEAK,EAAK,0BAA0B,iBAC3B,QACAG,CACJ,EAEAE,IAEAL,EAAK,aAAa,iBAAiB,QAASS,CAAmB,EAE/DT,EAAK,SAAS,iBAAiB,SAAUuB,CAAkB"}