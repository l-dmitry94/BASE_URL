{"version":3,"file":"commonHelpers2.js","sources":["../src/js/services/modals-footer.js","../src/js/requests/subscription.js","../src/js/products/discount.js","../src/js/products/popular.js","../src/js/products/add-to-cart.js","../src/main.js"],"sourcesContent":["import * as basicLightbox from 'basiclightbox';\nimport 'basiclightbox/dist/basicLightbox.min.css';\n\n// !-----------------------------New-Subscriber-------------------------------\nexport const modalFooterNewSubscr = function () {\n    let closeBtn;\n    const instance = basicLightbox.create(\n        `\n    <div class=\"modal\">\n    <div class=\"footer__modal\">\n        <button type=\"button\" class=\"footer__modal-close\">\n            <svg class=\"footer__modal-icon\">\n                <use href=\"../../img/icons.svg#icon-close\"></use>\n            </svg>\n        </button>\n        <div class=\"footer__modal-title-text\">\n            <h2 class=\"footer__modal-title\">\n                Thanks for subscribing for\n                <span class=\"footer__modal-span\">new </span>products\n            </h2>\n            <p class=\"footer__modal-text\">\n                We promise you organic and high-quality products that will meet\n                your expectations. Please stay with us and we promise you many\n                pleasant surprises.\n            </p>\n        </div>\n        <div class=\"footer__modal-png\">\n            <img\n                src=\"../../img/footer/subscription.png.png\"\n                alt=\"bascket of products\"\n            />\n        </div>\n    </div>\n</div>\n`,\n        {\n            onShow: instance => {\n                window.addEventListener('keydown', handelClickOnEscap);\n                closeBtn = instance\n                    .element()\n                    .querySelector('.footer__modal-close');\n                closeBtn.addEventListener('click', () => instance.close());\n                document.body.classList.add('modal-open');\n            },\n            onClose: () => {\n                closeBtn.removeEventListener('click', () => instance.close());\n                window.removeEventListener('keydown', handelClickOnEscap);\n                document.body.classList.remove('modal-open');\n            },\n        }\n    );\n\n    instance.show();\n    function handelClickOnEscap(eve) {\n        if (eve.code === 'Escape') {\n            instance.close();\n        }\n    }\n};\n// !-----------------------------Existed-Subscriber-------------------------------\nexport const modalFooterExistedSubscr = function () {\n    let closeBtn;\n    const instance = basicLightbox.create(\n        `\n        <div class=\"modal\">\n        <div class=\"footer__modal-Existed\">\n            <button type=\"button\" class=\"footer__modal-close\">\n                <svg class=\"footer__modal-icon\">\n                    <use href=\"../../img/icons.svg#icon-close\"></use>\n                </svg>\n            </button>\n            <div class=\"footer__modal-title-text-Existed\">\n                <h2 class=\"footer__modal-title-Existed\">\n                    This\n                    <span class=\"footer__modal-span-Existed\">email address</span>\n                    has already been entered\n                </h2>\n                <p class=\"footer__modal-text-Existed\">\n                    You have already subscribed to our new products. Watch for\n                    offers at the mailing address.\n                </p>\n            </div>\n        </div>\n    </div>\n`,\n        {\n            onShow: instance => {\n                window.addEventListener('keydown', handelClickOnEscap);\n                closeBtn = instance\n                    .element()\n                    .querySelector('.footer__modal-close');\n                closeBtn.addEventListener('click', () => instance.close());\n                document.body.classList.add('modal-open');\n            },\n            onClose: () => {\n                closeBtn.removeEventListener('click', () => instance.close());\n                window.removeEventListener('keydown', handelClickOnEscap);\n                document.body.classList.remove('modal-open');\n            },\n        }\n    );\n\n    instance.show();\n    function handelClickOnEscap(eve) {\n        if (eve.code === 'Escape') {\n            instance.close();\n        }\n    }\n};\n","import { apiSubscription } from '../services/api';\nimport {\n    modalFooterNewSubscr,\n    modalFooterExistedSubscr,\n} from '../services/modals-footer';\nimport { footerFormRef } from '../services/refs';\n\nfooterFormRef.addEventListener('submit', handleForm);\n\nexport function handleForm(e) {\n    e.preventDefault();\n    const { value } = e.currentTarget.elements.email;\n\n    postSubscriptionNewProducts(value);\n    e.target.reset();\n}\n\nasync function postSubscriptionNewProducts(value) {\n    try {\n        const response = await apiSubscription({\n            method: 'POST',\n            data: {\n                email: value,\n            },\n        });\n        if (response.statusText === 'Created') {\n            modalFooterNewSubscr();\n        }\n    } catch ({ response }) {\n        if (response.statusText === 'Conflict') {\n            modalFooterExistedSubscr();\n        }\n    }\n}\n","import { apiProducts } from '../services/api';\nimport { refs } from '../services/refs';\nimport { createDiscountCards } from '../services/markup';\n\nexport async function fetchAllDiscount() {\n    const response = await apiProducts({\n        method: 'GET',\n        url: '/discount',\n    });\n\n    return response.data;\n}\n","import { apiProducts } from '../services/api';\nimport { refs } from '../services/refs';\nimport { createPopularCards } from '../services/markup';\n\nexport async function fetchAllPopular() {\n    const response = await apiProducts({\n        method: 'GET',\n        url: '/popular',\n    });\n\n    return response.data;\n}\n","import { common } from \"../common/common\";\nimport { fetchProduct } from \"../requests/products\";\nimport {getData} from '../services/storage';\nimport check from '../../img/icons.svg'\n\nconst cartArr = getData(common.CART_KEY)\n\nexport async function addToCart(event) {\n    const {target} = event;\n\n    const addBtn = target.closest(\".cards__button\");\n\n    if(!addBtn) {\n        return\n    }\n\n    const {id} = addBtn.closest(\".cards__item\").dataset;\n\n    const product = await fetchProduct(id);\n\n    const inStorage = cartArr.some(({_id}) => id === _id);\n\n    if(inStorage) {\n        return\n    }\n\n    cartArr.push(product);\n\n    const quantity = document.querySelector(\".header__menu-link-quantity\");\n        quantity.textContent = cartArr.length;\n    \n    localStorage.setItem(common.CART_KEY, JSON.stringify(cartArr));\n\n    const checkItem = cartArr.some(({_id}) => id === _id);\n\n    if(checkItem) {\n        addBtn.innerHTML = `<svg class=\"icon-checked\"><use href=\"${check}#icon-check\"></use></svg>`\n    }\n}","// import SlimSelect from 'slim-select';\n// import \"slim-select/dist/slimselect.css\"\n\nimport { handleForm } from './js/requests/subscription';\nimport { fetchAllCategories } from './js/requests/products';\nimport { fetchAllProducts } from './js/requests/products';\nimport { refs } from './js/services/refs';\nimport { dataAsString } from './js/services/refs';\nimport {\n    createFiltresCards,\n    createDiscountCards,\n    createPopularCards,\n} from './js/services/markup';\nimport { handleChange } from './js/products/products';\nimport { handleSubmit } from './js/products/products';\nimport { normalizeCategory } from './js/products/products';\n// Отримуємо всі категорії\nimport { fetchAllDiscount } from './js/products/discount';\nimport { fetchAllPopular } from './js/products/popular';\nimport { addToCart } from './js/products/add-to-cart';\nimport { handleCart } from './js/cart/cart';\nimport { quantityProduct } from './js/helpers/helpers';\nimport { getData } from './js/services/storage';\nimport { common } from './js/common/common';\n\n\n\nfetchAllCategories().then(data => {\n    let modifiedCategories = data.map(data => {\n        return normalizeCategory(data);\n    });\n    localStorage.setItem('filter', dataAsString);\n    let markupList = modifiedCategories\n        .map(key => `<option value=\"${key}\">${normalizeCategory(key)}</option>`)\n        .join('');\n\n    let additionalGender = `<option  selected  >Show all</option>`;\n    refs.productsFiltersSelect.innerHTML = markupList + additionalGender;\n    // new SlimSelect({\n    //     select: refs.productsFiltersSelect,\n    //     showSearch: false,\n    //   })\n}).catch;\n\n// Отримуємо всі продукти\nfetchAllProducts().then(data => {\n    let test1 = createFiltresCards(data.results);\n    refs.productsCards.innerHTML = test1;\n}).catch();\n\n// Функція обробки submit в секції filters\nrefs.productsFiltersSelect.addEventListener('change', handleChange);\n// Функція обробки submit в секції filters\nrefs.btnSubmit.addEventListener('submit', handleSubmit);\n\n\n\nrefs.productsFiltersSelect.addEventListener('change', handleChange);\nfetchAllDiscount().then(data => {\n    let discount = createDiscountCards(data.slice(0, 2));\n    refs.discountCards.innerHTML = discount;\n}).catch;\n\nfetchAllPopular().then(data => {\n    let popular = createPopularCards(data.slice(0, 5));\n    refs.popularCards.innerHTML = popular;\n}).catch;\n\nrefs.productsCards.addEventListener(\"click\", (event) => event.preventDefault())\n\nrefs.productsCards.addEventListener(\"click\", addToCart);\n\nconst cartArr = getData(common.CART_KEY);\nquantityProduct(cartArr);"],"names":["modalFooterNewSubscr","closeBtn","instance","basicLightbox.create","handelClickOnEscap","eve","modalFooterExistedSubscr","footerFormRef","handleForm","value","postSubscriptionNewProducts","apiSubscription","response","fetchAllDiscount","apiProducts","fetchAllPopular","cartArr","getData","common","addToCart","event","target","addBtn","id","product","fetchProduct","_id","quantity","check","fetchAllCategories","data","modifiedCategories","normalizeCategory","dataAsString","markupList","key","additionalGender","refs","fetchAllProducts","test1","createFiltresCards","handleChange","handleSubmit","discount","createDiscountCards","popular","createPopularCards","quantityProduct"],"mappings":"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"}