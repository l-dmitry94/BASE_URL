import{f as I,h as R,r as t,i as y,j as B,k as K,g as C,c as g,l as q,m as h,n as Y,s as k,o as F,p as w,t as T,u as D,v,w as b,x as M,y as O,z as P,A as J,B as N,q as j}from"./assets/subscription-647d1d30.js";import{b as z,S as G,c as V,P as H}from"./assets/vendor-59e0408b.js";I().then(o=>{let s=R(o.slice(0,2));t.discountCards.innerHTML=s,y()}).catch;B().then(o=>{let s=K(o.slice(0,5));t.popularCards.innerHTML=s,y()}).catch;const _=C(g.CART_KEY);async function L(o){const{target:s}=o,r=s.closest(".cards__button");if(!r)return;const{id:a}=r.closest(".cards__item").dataset,e=await q(a);if(_.some(({_id:l})=>a===l))return;const m=document.querySelector(".header__menu-link-quantity");m.textContent=_.length,_.push(e),localStorage.setItem(g.CART_KEY,JSON.stringify(_)),_.forEach(({_id:l})=>{document.querySelectorAll(`[data-id="${l}"]`).forEach(c=>{const i=c.querySelector(".cards__button");i.innerHTML=`<svg class="icon-checked"><use href="${h}#icon-check"></use></svg>`})})}const A=document.body;async function E(o){o.preventDefault();const{target:s}=o,r=s.closest(".cards__button"),a=s.closest(".cards__link");if(r||!a)return;const{id:e}=a.closest(".cards__item").dataset,f=await q(e),m=n=>{const c=C(g.CART_KEY);if(c.find(({_id:d})=>e===d)){const d=c.findIndex(({_id:p})=>p===e);d!==-1&&c.splice(d,1);const S=document.querySelector(".header__menu-link-quantity");S.textContent=c.length,k(c,g.CART_KEY),c.length||localStorage.removeItem(g.CART_KEY),document.querySelectorAll(`[data-id="${e}"] .cards__button`).forEach(p=>{p.innerHTML=`<svg class="icon__cart" width="18" height="18"><use href="${h}#icon-cart"></use></svg>`,p.closest(".popular__item")&&(p.innerHTML=`<svg class="cart-green" width="18" height="18"><use href="${h}#icon-cart"></use></svg>`)}),n.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${h}#icon-cart"></use></svg>`}else{if(c.some(({_id:u})=>e===u))return;c.push(f);const S=document.querySelector(".header__menu-link-quantity");S.textContent=c.length,k(c,g.CART_KEY),c.forEach(({_id:u})=>{document.querySelectorAll(`[data-id="${u}"]`).forEach($=>{const x=$.querySelector(".cards__button");x.innerHTML=`<svg class="icon-checked"><use href="${h}#icon-check"></use></svg>`})}),n.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${h}#icon-cart"></use></svg>`}};z.create(Y(f),{onShow:n=>{A.classList.add("modal-open"),window.addEventListener("keydown",u=>{u.code==="Escape"&&n.close()});const i=n.element().querySelector(".modal__item").querySelector(".cards__button");C(g.CART_KEY).find(({_id:u})=>u===e)?i.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${h}#icon-cart"></use></svg>`:i.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${h}#icon-cart"></use></svg>`,i.addEventListener("click",()=>m(i)),y(),n.element().querySelector(".modal__item-close").onclick=n.close},onClose:n=>{A.classList.remove("modal-open"),window.removeEventListener("keydown",d=>{d.code==="Escape"&&n.close()});const i=n.element().querySelector(".modal__item").querySelector(".cards__button");i.removeEventListener("click",()=>m(i))}}).show(),new G(document.querySelector(".cards__desc-modal"))}F().then(o=>{let s=o.map(e=>w(e));localStorage.setItem("filter",T);let r=s.map(e=>`<option value="${e}">${w(e)}</option>`).join(""),a="<option  selected  >Show all</option>";t.productsFiltersSelect.innerHTML=r+a,new V({select:t.productsFiltersSelect,showSearch:!1})}).catch;D().then(o=>{console.log(v);let s=b(o.results);t.productsCards.innerHTML=s,v.totalItems=o.perPage*o.totalPages,new H(M,v).on("beforeMove",O),y()}).catch();t.productsFiltersSelect.addEventListener("change",P);t.btnSubmit.addEventListener("submit",J);t.productsFiltersSelect.addEventListener("change",P);const Q=new H(M,v);Q.on("beforeMove",o=>{const s=o.page,r=t.productsFiltersSelect.options[t.productsFiltersSelect.selectedIndex];let a=localStorage.getItem("filter"),e=a?JSON.parse(a):{};const f=r.textContent!=="Show all"?r.textContent:null;e.category=f;let m=T;e.page=s,localStorage.setItem("filter",JSON.stringify(e)),e.keyword===null&&e.category===null&&N(s,e.limit).then(l=>{let n=b(l.results);console.log(e.page),localStorage.setItem("filter",m),t.productsCards.innerHTML=n}).catch(l=>{console.error(l)})});t.productsCards.addEventListener("click",L);t.popularCards.addEventListener("click",L);t.discountCards.addEventListener("click",L);const U=C(g.CART_KEY);j(U);t.productsCards.addEventListener("click",E);t.popularCards.addEventListener("click",E);t.discountCards.addEventListener("click",E);
//# sourceMappingURL=commonHelpers2.js.map
