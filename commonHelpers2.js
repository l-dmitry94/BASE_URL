import{f as B,h as I,r as e,i as y,j as R,k as K,g as C,c as h,l as q,m,n as Y,s as k,o as F,p as A,t as T,u as D,v,w as b,x as P,y as O,z as M,A as J,B as N,q as j}from"./assets/subscription-5b33a1c9.js";import{b as z,S as G,c as V,P as H}from"./assets/vendor-59e0408b.js";B().then(o=>{let c=I(o.slice(0,2));e.discountCards.innerHTML=c,y()}).catch;R().then(o=>{let c=K(o.slice(0,5));e.popularCards.innerHTML=c,y()}).catch;const f=C(h.CART_KEY);async function L(o){const{target:c}=o,r=c.closest(".cards__button");if(!r)return;const{id:a}=r.closest(".cards__item").dataset,t=await q(a);if(f.some(({_id:l})=>a===l))return;f.push(t);const g=document.querySelector(".header__menu-link-quantity");g.textContent=f.length,localStorage.setItem(h.CART_KEY,JSON.stringify(f)),f.forEach(({_id:l})=>{document.querySelectorAll(`[data-id="${l}"]`).forEach(n=>{const i=n.querySelector(".cards__button");i.innerHTML=`<svg class="icon-checked"><use href="${m}#icon-check"></use></svg>`})})}const w=document.body;async function E(o){o.preventDefault();const{target:c}=o,r=c.closest(".cards__button"),a=c.closest(".cards__link");if(r||!a)return;const{id:t}=a.closest(".cards__item").dataset,p=await q(t),g=s=>{const n=C(h.CART_KEY);if(n.find(({_id:d})=>t===d)){const d=n.findIndex(({_id:S})=>S===t);d!==-1&&n.splice(d,1);const _=document.querySelector(".header__menu-link-quantity");_.textContent=n.length,k(n,h.CART_KEY),n.length||localStorage.removeItem(h.CART_KEY),document.querySelectorAll(`[data-id="${t}"] .cards__button`).forEach(S=>{S.innerHTML=`<svg class="icon__cart" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`}),s.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`}else{if(n.some(({_id:u})=>t===u))return;n.push(p);const _=document.querySelector(".header__menu-link-quantity");_.textContent=n.length,k(n,h.CART_KEY),n.forEach(({_id:u})=>{document.querySelectorAll(`[data-id="${u}"]`).forEach($=>{const x=$.querySelector(".cards__button");x.innerHTML=`<svg class="icon-checked"><use href="${m}#icon-check"></use></svg>`})}),s.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`}};z.create(Y(p),{onShow:s=>{w.classList.add("modal-open"),window.addEventListener("keydown",u=>{u.code==="Escape"&&s.close()});const i=s.element().querySelector(".modal__item").querySelector(".cards__button");C(h.CART_KEY).find(({_id:u})=>u===t)?i.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`:i.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`,i.addEventListener("click",()=>g(i)),y(),s.element().querySelector(".modal__item-close").onclick=s.close},onClose:s=>{w.classList.remove("modal-open"),window.removeEventListener("keydown",d=>{d.code==="Escape"&&s.close()});const i=s.element().querySelector(".modal__item").querySelector(".cards__button");i.removeEventListener("click",()=>g(i))}}).show(),new G(document.querySelector(".cards__desc-modal"))}F().then(o=>{let c=o.map(t=>A(t));localStorage.setItem("filter",T);let r=c.map(t=>`<option value="${t}">${A(t)}</option>`).join(""),a="<option  selected  >Show all</option>";e.productsFiltersSelect.innerHTML=r+a,new V({select:e.productsFiltersSelect,showSearch:!1})}).catch;D().then(o=>{console.log(v);let c=b(o.results);e.productsCards.innerHTML=c,v.totalItems=o.perPage*o.totalPages,new H(P,v).on("beforeMove",O),y()}).catch();e.productsFiltersSelect.addEventListener("change",M);e.btnSubmit.addEventListener("submit",J);e.productsFiltersSelect.addEventListener("change",M);const Q=new H(P,v);Q.on("beforeMove",o=>{const c=o.page,r=e.productsFiltersSelect.options[e.productsFiltersSelect.selectedIndex];let a=localStorage.getItem("filter"),t=a?JSON.parse(a):{};const p=r.textContent!=="Show all"?r.textContent:null;t.category=p;let g=T;t.page=c,localStorage.setItem("filter",JSON.stringify(t)),t.keyword===null&&t.category===null&&N(c,t.limit).then(l=>{let s=b(l.results);console.log(t.page),localStorage.setItem("filter",g),e.productsCards.innerHTML=s}).catch(l=>{console.error(l)})});e.productsCards.addEventListener("click",L);e.popularCards.addEventListener("click",L);e.discountCards.addEventListener("click",L);const U=C(h.CART_KEY);j(U);e.productsCards.addEventListener("click",E);e.popularCards.addEventListener("click",E);e.discountCards.addEventListener("click",E);
//# sourceMappingURL=commonHelpers2.js.map
