import{f as x,h as H,r as o,i as C,j as I,k as R,g as v,c as u,l as A,m as f,n as $,s as k,o as D,p as E,t as P,u as F,v as S,w as T,x as q,y as K,z as b,A as Y,B,q as O}from"./assets/subscription-93a71bbf.js";import{b as J,S as N,P as M}from"./assets/vendor-235ad0d8.js";x().then(t=>{let s=H(t.slice(0,2));o.discountCards.innerHTML=s,C()}).catch;I().then(t=>{let s=R(t.slice(0,5));o.popularCards.innerHTML=s,C()}).catch;const p=v(u.CART_KEY);async function L(t){const{target:s}=t,c=s.closest(".cards__button");if(!c)return;const{id:a}=c.closest(".cards__item").dataset,e=await A(a);if(p.some(({_id:n})=>a===n))return;p.push(e);const m=document.querySelector(".header__menu-link-quantity");m.textContent=p.length,localStorage.setItem(u.CART_KEY,JSON.stringify(p)),p.some(({_id:n})=>a===n)&&(c.innerHTML=`<svg class="icon-checked"><use href="${f}#icon-check"></use></svg>`)}const w=document.body;async function y(t){t.preventDefault();const{target:s}=t,c=s.closest(".cards__button"),a=s.closest(".cards__link");if(c||!a)return;const{id:e}=a.closest(".cards__item").dataset,h=await A(e),m=n=>{const r=v(u.CART_KEY);if(r.some(({_id:l})=>e===l)){const l=r.findIndex(({_id:d})=>d===e);l!==-1&&r.splice(l,1);const _=document.querySelector(".header__menu-link-quantity");_.textContent=r.length,k(r,u.CART_KEY),n.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${f}#icon-cart"></use></svg>`}else{if(r.some(({_id:d})=>e===d))return;r.push(h);const _=document.querySelector(".header__menu-link-quantity");_.textContent=r.length,k(r,u.CART_KEY),n.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${f}#icon-cart"></use></svg>`}};J.create($(h),{onShow:n=>{w.classList.add("modal-open"),window.addEventListener("keydown",d=>{d.code==="Escape"&&n.close()});const i=n.element().querySelector(".modal__item").querySelector(".cards__button");v(u.CART_KEY).find(({_id:d})=>d===e)?i.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${f}#icon-cart"></use></svg>`:i.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${f}#icon-cart"></use></svg>`,i.addEventListener("click",()=>m(i)),C(),n.element().querySelector(".modal__item-close").onclick=n.close},onClose:n=>{w.classList.remove("modal-open"),window.removeEventListener("keydown",l=>{l.code==="Escape"&&n.close()});const i=n.element().querySelector(".modal__item").querySelector(".cards__button");i.removeEventListener("click",()=>m(i))}}).show()}D().then(t=>{let s=t.map(e=>E(e));localStorage.setItem("filter",P);let c=s.map(e=>`<option value="${e}">${E(e)}</option>`).join(""),a="<option  selected  >Show all</option>";o.productsFiltersSelect.innerHTML=c+a,new N({select:o.productsFiltersSelect,showSearch:!1})}).catch;F().then(t=>{console.log(S);let s=T(t.results);o.productsCards.innerHTML=s,S.totalItems=t.perPage*t.totalPages,new M(q,S).on("beforeMove",K),C()}).catch();o.productsFiltersSelect.addEventListener("change",b);o.btnSubmit.addEventListener("submit",Y);o.productsFiltersSelect.addEventListener("change",b);const j=new M(q,S);j.on("beforeMove",t=>{const s=t.page,c=o.productsFiltersSelect.options[o.productsFiltersSelect.selectedIndex];let a=localStorage.getItem("filter"),e=a?JSON.parse(a):{};const h=c.textContent!=="Show all"?c.textContent:null;e.category=h;let m=P;e.page=s,localStorage.setItem("filter",JSON.stringify(e)),e.keyword===null&&e.category===null&&B(s,e.limit).then(g=>{let n=T(g.results);console.log(e.page),localStorage.setItem("filter",m),o.productsCards.innerHTML=n}).catch(g=>{console.error(g)})});o.productsCards.addEventListener("click",t=>t.preventDefault());o.productsCards.addEventListener("click",L);o.popularCards.addEventListener("click",L);o.discountCards.addEventListener("click",L);const z=v(u.CART_KEY);O(z);o.productsCards.addEventListener("click",y);o.popularCards.addEventListener("click",y);o.discountCards.addEventListener("click",y);
//# sourceMappingURL=commonHelpers2.js.map
