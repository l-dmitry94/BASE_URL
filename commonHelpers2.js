import{f as I,h as x,r as t,i as C,j as H,k as R,g as v,c as d,l as A,m as f,n as K,s as k,o as Y,p as E,t as T,u as $,v as S,w as P,x as q,y as F,z as b,A as B,B as D,q as O}from"./assets/subscription-18dec4e6.js";import{b as J,c as N,P as M}from"./assets/vendor-59e0408b.js";I().then(o=>{let s=x(o.slice(0,2));t.discountCards.innerHTML=s,C()}).catch;H().then(o=>{let s=R(o.slice(0,5));t.popularCards.innerHTML=s,C()}).catch;const p=v(d.CART_KEY);async function L(o){const{target:s}=o,a=s.closest(".cards__button");if(!a)return;const{id:r}=a.closest(".cards__item").dataset,e=await A(r);if(p.some(({_id:n})=>r===n))return;p.push(e);const m=document.querySelector(".header__menu-link-quantity");m.textContent=p.length,localStorage.setItem(d.CART_KEY,JSON.stringify(p)),p.some(({_id:n})=>r===n)&&(a.innerHTML=`<svg class="icon-checked"><use href="${f}#icon-check"></use></svg>`)}const w=document.body;async function y(o){o.preventDefault();const{target:s}=o,a=s.closest(".cards__button"),r=s.closest(".cards__link");if(a||!r)return;const{id:e}=r.closest(".cards__item").dataset,g=await A(e),m=n=>{const c=v(d.CART_KEY);if(c.find(({_id:l})=>e===l)){const l=c.findIndex(({_id:u})=>u===e);l!==-1&&c.splice(l,1);const _=document.querySelector(".header__menu-link-quantity");_.textContent=c.length,k(c,d.CART_KEY),c.length||localStorage.removeItem(d.CART_KEY),n.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${f}#icon-cart"></use></svg>`}else{if(c.some(({_id:u})=>e===u))return;c.push(g);const _=document.querySelector(".header__menu-link-quantity");_.textContent=c.length,k(c,d.CART_KEY),n.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${f}#icon-cart"></use></svg>`}};J.create(K(g),{onShow:n=>{w.classList.add("modal-open"),window.addEventListener("keydown",u=>{u.code==="Escape"&&n.close()});const i=n.element().querySelector(".modal__item").querySelector(".cards__button");v(d.CART_KEY).find(({_id:u})=>u===e)?i.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${f}#icon-cart"></use></svg>`:i.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${f}#icon-cart"></use></svg>`,i.addEventListener("click",()=>m(i)),C(),n.element().querySelector(".modal__item-close").onclick=n.close},onClose:n=>{w.classList.remove("modal-open"),window.removeEventListener("keydown",l=>{l.code==="Escape"&&n.close()});const i=n.element().querySelector(".modal__item").querySelector(".cards__button");i.removeEventListener("click",()=>m(i))}}).show()}Y().then(o=>{let s=o.map(e=>E(e));localStorage.setItem("filter",T);let a=s.map(e=>`<option value="${e}">${E(e)}</option>`).join(""),r="<option  selected  >Show all</option>";t.productsFiltersSelect.innerHTML=a+r,new N({select:t.productsFiltersSelect,showSearch:!1})}).catch;$().then(o=>{console.log(S);let s=P(o.results);t.productsCards.innerHTML=s,S.totalItems=o.perPage*o.totalPages,new M(q,S).on("beforeMove",F),C()}).catch();t.productsFiltersSelect.addEventListener("change",b);t.btnSubmit.addEventListener("submit",B);t.productsFiltersSelect.addEventListener("change",b);const j=new M(q,S);j.on("beforeMove",o=>{const s=o.page,a=t.productsFiltersSelect.options[t.productsFiltersSelect.selectedIndex];let r=localStorage.getItem("filter"),e=r?JSON.parse(r):{};const g=a.textContent!=="Show all"?a.textContent:null;e.category=g;let m=T;e.page=s,localStorage.setItem("filter",JSON.stringify(e)),e.keyword===null&&e.category===null&&D(s,e.limit).then(h=>{let n=P(h.results);console.log(e.page),localStorage.setItem("filter",m),t.productsCards.innerHTML=n}).catch(h=>{console.error(h)})});t.productsCards.addEventListener("click",L);t.popularCards.addEventListener("click",L);t.discountCards.addEventListener("click",L);const z=v(d.CART_KEY);O(z);t.productsCards.addEventListener("click",y);t.popularCards.addEventListener("click",y);t.discountCards.addEventListener("click",y);
//# sourceMappingURL=commonHelpers2.js.map
