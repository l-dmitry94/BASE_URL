import{f as I,h as R,r as t,i as C,j as B,k as K,g as v,c as h,l as m,m as Y,n as F,s as k,o as D,p as w,t as b,u as j,v as y,w as x,x as M,y as N,z as P,A as O,B as z,q as J}from"./assets/subscription-710678c0.js";import{b as V,S as G,c as Q,P as H}from"./assets/vendor-59e0408b.js";I().then(o=>{let s=R(o.slice(0,2));t.discountCards.innerHTML=s,C()}).catch;B().then(o=>{let s=K(o.slice(0,5));t.popularCards.innerHTML=s,C()}).catch;const S=v(h.CART_KEY);async function L(o){const{target:s}=o,r=s.closest(".cards__button");if(!r)return;console.log(r);const{id:d}=r.closest(".cards__item").dataset,e=r.closest(".cards__item"),g=[...e.querySelectorAll(".cards__info-value")].map(a=>a),p=e.querySelector("[data-category]"),n=p?p.textContent:"",c=e.querySelector(".cards__price"),l=c?c.textContent:"",i={_id:d,category:n.dataset.category?n.dataset.category:"",img:e.querySelector(".cards__image-photo-js").src?e.querySelector(".cards__image-photo-js").src:"",name:e.querySelector(".cards__title").textContent?e.querySelector(".cards__title").textContent:"",popularity:g[2].textContent?g[2].textContent:"",price:Number(l.slice(1))?Number(l.slice(1)):"",size:g[1].textContent?g[1].textContent:""};if(console.log(!!i),S.some(({_id:a})=>d===a))return;S.push(i);const u=document.querySelector(".header__menu-link-quantity");u.textContent=S.length,localStorage.setItem(h.CART_KEY,JSON.stringify(S)),S.forEach(({_id:a})=>{document.querySelectorAll(`[data-id="${a}"]`).forEach(E=>{const $=E.querySelector(".cards__button");$.innerHTML=`<svg class="icon-checked"><use href="${m}#icon-check"></use></svg>`})})}const T=document.body;async function q(o){o.preventDefault();const{target:s}=o,r=s.closest(".cards__button"),d=s.closest(".cards__link");if(r||!d)return;const{id:e}=d.closest(".cards__item").dataset,_=await Y(e),g=n=>{const c=v(h.CART_KEY);if(c.find(({_id:i})=>e===i)){const i=c.findIndex(({_id:a})=>a===e);i!==-1&&c.splice(i,1);const f=document.querySelector(".header__menu-link-quantity");f.textContent=c.length,k(c,h.CART_KEY),c.length||localStorage.removeItem(h.CART_KEY),document.querySelectorAll(`[data-id="${e}"] .cards__button`).forEach(a=>{a.innerHTML=`<svg class="icon__cart" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`,a.closest(".popular__item")&&(a.innerHTML=`<svg class="cart-green" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`)}),n.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`}else{if(c.some(({_id:u})=>e===u))return;c.push(_);const f=document.querySelector(".header__menu-link-quantity");f.textContent=c.length,k(c,h.CART_KEY),c.forEach(({_id:u})=>{document.querySelectorAll(`[data-id="${u}"]`).forEach(A=>{const E=A.querySelector(".cards__button");E.innerHTML=`<svg class="icon-checked"><use href="${m}#icon-check"></use></svg>`})}),n.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`}};V.create(F(_),{onShow:n=>{T.classList.add("modal-open"),window.addEventListener("keydown",u=>{u.code==="Escape"&&n.close()});const l=n.element().querySelector(".modal__item").querySelector(".cards__button");v(h.CART_KEY).find(({_id:u})=>u===e)?l.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`:l.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${m}#icon-cart"></use></svg>`,l.addEventListener("click",()=>g(l)),C(),n.element().querySelector(".modal__item-close").onclick=n.close},onClose:n=>{T.classList.remove("modal-open"),window.removeEventListener("keydown",i=>{i.code==="Escape"&&n.close()});const l=n.element().querySelector(".modal__item").querySelector(".cards__button");l.removeEventListener("click",()=>g(l))}}).show(),new G(document.querySelector(".cards__desc-modal"))}D().then(o=>{let s=o.map(e=>w(e));localStorage.setItem("filter",b);let r=s.map(e=>`<option value="${e}">${w(e)}</option>`).join(""),d="<option  selected  >Show all</option>";t.productsFiltersSelect.innerHTML=r+d,new Q({select:t.productsFiltersSelect,showSearch:!1})}).catch;j().then(o=>{console.log(y);let s=x(o.results);t.productsCards.innerHTML=s,y.totalItems=o.perPage*o.totalPages,new H(M,y).on("beforeMove",N),C()}).catch();t.productsFiltersSelect.addEventListener("change",P);t.btnSubmit.addEventListener("submit",O);t.productsFiltersSelect.addEventListener("change",P);const U=new H(M,y);U.on("beforeMove",o=>{const s=o.page,r=t.productsFiltersSelect.options[t.productsFiltersSelect.selectedIndex];let d=localStorage.getItem("filter"),e=d?JSON.parse(d):{};const _=r.textContent!=="Show all"?r.textContent:null;e.category=_;let g=b;e.page=s,localStorage.setItem("filter",JSON.stringify(e)),e.keyword===null&&e.category===null&&z(s,e.limit).then(p=>{let n=x(p.results);console.log(e.page),localStorage.setItem("filter",g),t.productsCards.innerHTML=n}).catch(p=>{console.error(p)})});t.productsCards.addEventListener("click",L);t.popularCards.addEventListener("click",L);t.discountCards.addEventListener("click",L);const W=v(h.CART_KEY);J(W);t.productsCards.addEventListener("click",q);t.popularCards.addEventListener("click",q);t.discountCards.addEventListener("click",q);
//# sourceMappingURL=commonHelpers2.js.map
