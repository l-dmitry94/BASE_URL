import{f as K,h as Y,r as t,i as q,j as F,k as D,g as L,c as h,l as g,m as j,n as z,s as T,o as N,p as b,t as P,u as O,v as C,w as x,x as H,y as J,z as $,A as V,B as G,q as Q}from"./assets/subscription-8e220c50.js";import{b as U,S as W,c as X,P as I}from"./assets/vendor-59e0408b.js";K().then(o=>{let s=Y(o.slice(0,2));t.discountCards.innerHTML=s,q()}).catch;F().then(o=>{let s=D(o.slice(0,5));t.popularCards.innerHTML=s,q()}).catch;const y=L(h.CART_KEY);async function A(o){var v,w;const{target:s}=o,r=s.closest(".cards__button");if(!r)return;const{id:l}=r.closest(".cards__item").dataset,e=r.closest(".cards__item"),m=[...e.querySelectorAll(".cards__info-value")].map(S=>S),u=e.querySelector("[data-category]"),n=(u==null?void 0:u.textContent)||"",c=e.querySelector(".cards__price"),i=c?c.textContent:"",d=((v=m[2])==null?void 0:v.textContent)||"",_=((w=m[1])==null?void 0:w.textContent)||"",a={_id:l,category:n,img:e.querySelector(".cards__image-photo-js").src?e.querySelector(".cards__image-photo-js").src:"",name:e.querySelector(".cards__title").textContent?e.querySelector(".cards__title").textContent:"",popularity:d,price:Number(i.slice(1)),size:_};if(console.log(!!a),y.some(({_id:S})=>l===S))return;y.push(a);const E=document.querySelector(".header__menu-link-quantity");E.textContent=y.length,localStorage.setItem(h.CART_KEY,JSON.stringify(y)),y.forEach(({_id:S})=>{document.querySelectorAll(`[data-id="${S}"]`).forEach(R=>{const B=R.querySelector(".cards__button");B.innerHTML=`<svg class="icon-checked"><use href="${g}#icon-check"></use></svg>`})})}const M=document.body;async function k(o){o.preventDefault();const{target:s}=o,r=s.closest(".cards__button"),l=s.closest(".cards__link");if(r||!l)return;const{id:e}=l.closest(".cards__item").dataset,f=await j(e),m=n=>{const c=L(h.CART_KEY);if(c.find(({_id:d})=>e===d)){const d=c.findIndex(({_id:p})=>p===e);d!==-1&&c.splice(d,1);const _=document.querySelector(".header__menu-link-quantity");_.textContent=c.length,T(c,h.CART_KEY),c.length||localStorage.removeItem(h.CART_KEY),document.querySelectorAll(`[data-id="${e}"] .cards__button`).forEach(p=>{p.innerHTML=`<svg class="icon__cart" width="18" height="18"><use href="${g}#icon-cart"></use></svg>`,p.closest(".popular__item")&&(p.innerHTML=`<svg class="cart-green" width="18" height="18"><use href="${g}#icon-cart"></use></svg>`)}),n.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${g}#icon-cart"></use></svg>`}else{if(c.some(({_id:a})=>e===a))return;c.push(f);const _=document.querySelector(".header__menu-link-quantity");_.textContent=c.length,T(c,h.CART_KEY),c.forEach(({_id:a})=>{document.querySelectorAll(`[data-id="${a}"]`).forEach(E=>{const v=E.querySelector(".cards__button");v.innerHTML=`<svg class="icon-checked"><use href="${g}#icon-check"></use></svg>`})}),n.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${g}#icon-cart"></use></svg>`}};U.create(z(f),{onShow:n=>{M.classList.add("modal-open"),window.addEventListener("keydown",a=>{a.code==="Escape"&&n.close()});const i=n.element().querySelector(".modal__item").querySelector(".cards__button");L(h.CART_KEY).find(({_id:a})=>a===e)?i.innerHTML=`Remove from <svg class="icon__cart" width="18" height="18"><use href="${g}#icon-cart"></use></svg>`:i.innerHTML=`Add to <svg class="icon__cart" width="18" height="18"><use href="${g}#icon-cart"></use></svg>`,i.addEventListener("click",()=>m(i)),q(),n.element().querySelector(".modal__item-close").onclick=n.close},onClose:n=>{M.classList.remove("modal-open"),window.removeEventListener("keydown",d=>{d.code==="Escape"&&n.close()});const i=n.element().querySelector(".modal__item").querySelector(".cards__button");i.removeEventListener("click",()=>m(i))}}).show(),new W(document.querySelector(".cards__desc-modal"))}N().then(o=>{let s=o.map(e=>b(e));localStorage.setItem("filter",P);let r=s.map(e=>`<option value="${e}">${b(e)}</option>`).join(""),l="<option  selected  >Show all</option>";t.productsFiltersSelect.innerHTML=r+l,new X({select:t.productsFiltersSelect,showSearch:!1})}).catch;O().then(o=>{console.log(C);let s=x(o.results);t.productsCards.innerHTML=s,C.totalItems=o.perPage*o.totalPages,new I(H,C).on("beforeMove",J),q()}).catch();t.productsFiltersSelect.addEventListener("change",$);t.btnSubmit.addEventListener("submit",V);t.productsFiltersSelect.addEventListener("change",$);const Z=new I(H,C);Z.on("beforeMove",o=>{const s=o.page,r=t.productsFiltersSelect.options[t.productsFiltersSelect.selectedIndex];let l=localStorage.getItem("filter"),e=l?JSON.parse(l):{};const f=r.textContent!=="Show all"?r.textContent:null;e.category=f;let m=P;e.page=s,localStorage.setItem("filter",JSON.stringify(e)),e.keyword===null&&e.category===null&&G(s,e.limit).then(u=>{let n=x(u.results);console.log(e.page),localStorage.setItem("filter",m),t.productsCards.innerHTML=n}).catch(u=>{console.error(u)})});t.productsCards.addEventListener("click",A);t.popularCards.addEventListener("click",A);t.discountCards.addEventListener("click",A);const ee=L(h.CART_KEY);Q(ee);t.productsCards.addEventListener("click",k);t.popularCards.addEventListener("click",k);t.discountCards.addEventListener("click",k);
//# sourceMappingURL=commonHelpers2.js.map
